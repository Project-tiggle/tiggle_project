<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="orgRegistMapper">

	<resultMap id="resultOrgRegist" type="OrgRegist">
	       <result property="uuid" column="UUID" />
	       <result property="totalId" column="TOTAL_ID" />
	       <result property="title" column="TITLE" />
	       <result property="contributor" column="CONTRIBUTOR" />
	       <result property="eDescription" column="E_DESCRIPTION" />
	       <result property="eventSite" column="EVENT_SITE" />
	       <result property="detailEventSite" column="DETAIL_EVENT_SITE" />
	       <result property="latitude" column="LATITUDE" />
	       <result property="longitude" column="LONGITUDE" />
	       <result property="genre" column="GENRE" />
	       <result property="contactPoint" column="CONTACT_POINT" />
	       <result property="viewCounter" column="VIEW_COUNTER" />
	       <result property="eUrl" column="E_URL" />
	       <result property="startDate" column="START_DATE" />
	       <result property="endDate" column="END_DATE" />
	       <result property="approvalStatus" column="APPROVAL_STATUS" />
	       <result property="eCategory" column="E_CATEGORY" />
	       <result property="fileUrl" column="FILE_URL" />
	       <result property="name" column="NAME" />
	       <result property="mngDept" column="MNG_DEPT" />
	       <result property="mngJobId" column="MNG_JOBID" />
	       <result property="phone" column="PHONE" />
	       <result property="email" column="EMAIL" />
	</resultMap>
	
	<!-- 전시/박람회 등록하기(insert & update) -->
	<insert id="insertOrgRegist" parameterType="OrgRegist">
		insert into tb_exhibition_fair
		values (#{ uuid }, #{ totalId }, #{ title }, #{ contributor }, #{ eDescription },
				#{ eventSite }, #{ detailEventSite }, #{ latitude }, #{ longitude }, #{ genre },
				#{ contactPoint }, #{ viewCounter }, #{ eUrl }, #{ startDate }, #{ endDate },
				#{ approvalStatus }, #{ eCategory }, #{ fileUrl })
	</insert>
	<update id="updateOrgRegist" parameterType="OrgRegist">			
		update tb_member
		set name = #{ name }, mng_dept = #{ mngDept }, mng_jobid = #{ mngJobId },
			phone = #{ phone }, email = #{ email }
		where uuid = #{ uuid }
	</update>
	
	<!-- 전시/박람회 등록시 필요한 totalid + 1 작업용 -->
	<select id="selectMaxTotalId" resultType="_int">
		select max(to_number(total_id))
		from tb_exhibition_fair
	</select>
	 
	<!-- 전시/박람회 정보 불러오기 -->
    <select id="selectOrgRegistByUuid" parameterType="string" resultMap="resultOrgRegist">
        select *
		from tb_exhibition_fair
		join tb_member using (uuid)
		where uuid = #{ uuid } and rownum = '1'
    </select>
	
</mapper>
